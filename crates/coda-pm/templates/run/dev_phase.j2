You are implementing a new feature in an existing codebase. This is **development phase {{ phase_number }}/{{ total_dev_phases }}: {{ phase_name }}**.

## Design Specification

{% if is_first %}
{{ design_spec }}
{% else %}
Refer to the full design specification provided in the first development phase above. The spec file is at `.coda/{{ feature_slug }}/specs/design.md` if you need to re-read any section.
{% endif %}

{% if resume_context %}
## Resume Context

{{ resume_context }}
{% endif %}

## Current Phase

You are working on **Phase {{ phase_number }}: {{ phase_name }}** of the development plan. Locate the corresponding phase in the "Development Phases" section of the design spec above and implement it completely.
{% if phase_goal %}

**Phase Goal**: {{ phase_goal }}
{% endif %}
{% if phase_files %}
**Expected File Changes**: {{ phase_files | join(", ") }}
{% endif %}

{% if is_first %}
## First Phase — Setup & Scaffolding

Since this is the **first** development phase, you may also need to:

1. **Create new directories** listed in the "Directory Structure" section
2. **Create scaffold files** with module declarations, struct/enum definitions, and `use` imports
3. **Update existing files** to register new modules (e.g., `mod` statements, `Cargo.toml` dependencies)

The `.coda/{{ feature_slug }}/` directory contains the design spec, verification plan, and execution state for this feature. It must be tracked in git.
{% endif %}

## Task

Implement all code changes described in this phase.

### Implementation

1. **Implement production code** — Write the code described in this phase
   - Follow the interface design from the spec exactly
   - Handle all error cases properly — no `unwrap()` or `expect()` in production code
   - Add appropriate logging with `tracing` macros
   - Add doc comments (`///`) for all public items with at least one example
2. **Write tests** — Create unit tests in `#[cfg(test)] mod tests` for all new functionality
   - Use descriptive names: `test_should_<expected_behavior>_when_<condition>`
   - Cover happy path, error cases, and edge cases
3. **Verify** — Run tests and ensure all pass

## Commit

Once all checks pass, commit with an appropriate conventional commit message:

```bash
{% if is_first %}
git add -A
{% endif %}
git commit -am "feat({{ feature_slug }}): {{ phase_name }}"
```

## Guidelines

- Implement ONLY what is described in this phase — do not jump ahead
- Use the project's existing patterns and conventions
- Add inline comments only for non-obvious logic
